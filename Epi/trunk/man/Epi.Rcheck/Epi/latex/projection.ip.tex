\HeaderA{projection.ip}{Projection of columns of a matrix.}{projection.ip}
\keyword{array}{projection.ip}
\begin{Description}\relax
Projects the columns of the matrix \code{M} on the space spanned by the
columns of the matrix \code{X}, with respect to the inner product
defined by \code{weight}: \code{<x|y>=sum(x*w*y)}.
\end{Description}
\begin{Usage}
\begin{verbatim}
projection.ip(X, M, orth = FALSE, weight = rep(1, nrow(X)))
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{X}] Matrix defining the space to project onto. 
\item[\code{M}] Matrix of columns to be projected. Must have the same number
of rows as \code{X}. 
\item[\code{orth}] Should the projection be on the orthogonal complement to
\code{span(X)}? 
\item[\code{weight}] Weights defining the inner product. Numerical vector of
length \code{nrow(X)}. 
\end{ldescription}
\end{Arguments}
\begin{Value}
A matrix of full rank with columns in \code{span(X)}.
\end{Value}
\begin{Author}\relax
Bendix Carstensen, Steno Diabetes Center,
\url{http://www.pubhealth.ku.dk/~bxc}, with help from Peter Dalgaard.
\end{Author}
\begin{SeeAlso}\relax
\code{\LinkA{detrend}{detrend}}
\end{SeeAlso}

