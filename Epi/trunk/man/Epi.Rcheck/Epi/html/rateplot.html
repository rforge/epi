<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Functions to plot rates from a table classified by age and
calendar time (period)</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for rateplot {Epi}"><tr><td>rateplot {Epi}</td><td align="right">R Documentation</td></tr></table>
<h2>Functions to plot rates from a table classified by age and
calendar time (period)</h2>


<h3>Description</h3>

<p>
Produces plots of rates versus age, connected within period or cohort
(<code>Aplot</code>), rates versus period connected within age-groups
(<code>Pplot</code>) and rates and rates versus date of birth cohort
(<code>Cplot</code>). <code>rateplot</code> is a wrapper for these, allowing
to produce the four classical displays with a single call.
</p>


<h3>Usage</h3>

<pre>
rateplot( rates,
          which = c("ap","ac","pa","ca"),
            age = as.numeric( dimnames( rates )[[1]] ),
            per = as.numeric( dimnames( rates )[[2]] ),
           grid = FALSE,
         a.grid = grid,
         p.grid = grid,
         c.grid = grid,
          ygrid = grid,
       col.grid = gray( 0.9 ),
          a.lim = range( age, na.rm=TRUE ) + c(0,diff( range( age ) )/30),
          p.lim = range( per, na.rm=TRUE ) + c(0,diff( range( age ) )/30),
          c.lim = NULL, 
           ylim = range( rates[rates&gt;0], na.rm=TRUE ),
             at = NULL,
         labels = paste( at ),
          a.lab = "Age at diagnosis",
          p.lab = "Date of diagnosis",
          c.lab = "Date of birth",
           ylab = "Rates",
           type = "l",
            lwd = 2,
            lty = 1,
         log.ax = "y",
            las = 1,
            ann = FALSE,
          a.ann = ann,
          p.ann = ann,
          c.ann = ann,
          xannx = 1/20,
        cex.ann = 0.8,
         a.thin = seq( 1, length( age ), 2 ),
         p.thin = seq( 1, length( per ), 2 ),
         c.thin = seq( 2, length( age ) + length( per ) - 1, 2 ),
            col = par( "fg" ),
          a.col = col,
          p.col = col,
          c.col = col,
            ... )

Aplot( rates, age = as.numeric( dimnames( rates )[[1]] ),
       per = as.numeric( dimnames( rates )[[2]] ), grid = FALSE,
       a.grid = grid, ygrid = grid, col.grid = gray( 0.9 ),
       a.lim = range( age, na.rm=TRUE ), ylim = range( rates[rates&gt;0], na.rm=TRUE ),
       at = NULL, labels = paste( at ), a.lab = names( dimnames( rates ) )[1],
       ylab = deparse( substitute( rates ) ), type = "l", lwd = 2, lty = 1,
       col = par( "fg" ), log.ax = "y", las = 1, c.col = col, p.col = col,
       c.ann = FALSE, p.ann = FALSE, xannx = 1/20, cex.ann = 0.8,
       c.thin = seq( 2, length( age ) + length( per ) - 1, 2 ),
       p.thin = seq( 1, length( per ), 2 ), p.lines = TRUE,
       c.lines = !p.lines, ... )

Pplot( rates, age = as.numeric( dimnames( rates )[[1]] ),
       per = as.numeric( dimnames( rates )[[2]] ), grid = FALSE,
       p.grid = grid, ygrid = grid, col.grid = gray( 0.9 ),
       p.lim = range( per, na.rm=TRUE ) + c(0,diff(range(per))/30),
       ylim = range( rates[rates&gt;0], na.rm=TRUE ), p.lab = names( dimnames( rates ) )[2],
       ylab = deparse( substitute( rates ) ), at = NULL, labels = paste( at ),
       type = "l", lwd = 2, lty = 1, col = par( "fg" ), log.ax = "y",
       las = 1, ann = FALSE, cex.ann = 0.8, xannx = 1/20,
       a.thin = seq( 1, length( age ), 2 ), ... )

Cplot( rates, age = as.numeric( rownames( rates ) ),
       per = as.numeric( colnames( rates ) ), grid = FALSE,
       c.grid = grid, ygrid = grid, col.grid = gray( 0.9 ),
       c.lim = NULL, ylim = range( rates[rates&gt;0], na.rm=TRUE ),
       at = NULL, labels = paste( at ), c.lab = names( dimnames( rates ) )[2],
       ylab = deparse( substitute( rates ) ), type = "l", lwd = 2, lty = 1,
       col = par( "fg" ), log.ax = "y", las = 1, xannx = 1/20, ann = FALSE,
       cex.ann = 0.8, a.thin = seq( 1, length( age ), 2 ), ...  )

</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>rates</code></td>
<td>
A two-dimensional table (or array) with rates to be plotted. It is
assumed that the first dimension is age and the second is period.</td></tr>
<tr valign="top"><td><code>which</code></td>
<td>
A character vector with elements from
<code>c("ap","ac","apc","pa","ca")</code>, indication which plots should
be produced. One plot per element is produced. The first letter
indicates the x-axis of the plot, the remaining which groups
should be connected, i.e. <code>"pa"</code> will plot rates versus
period and connect age-classes, and <code>"apc"</code> will plot rates
versus age, and connect both periods and cohorts.</td></tr>
<tr valign="top"><td><code>age</code></td>
<td>
Numerical vector giving the means of the
age-classes. Defaults to the rownames of <code>rates</code> as numeric.</td></tr>
<tr valign="top"><td><code>per</code></td>
<td>
Numerical vector giving the means of the periods. Defaults
to the columnnames of <code>rates</code> as numeric.</td></tr>
<tr valign="top"><td><code>grid</code></td>
<td>
Logical indicating whether a background grid should be drawn.</td></tr>
<tr valign="top"><td><code>a.grid</code></td>
<td>
Logical indicating whether a background grid on the
age-axis should be drawn. If numerical it indicates the
age-coordinates of the grid.</td></tr>
<tr valign="top"><td><code>p.grid</code></td>
<td>
do. for the period.</td></tr>
<tr valign="top"><td><code>c.grid</code></td>
<td>
do. for the cohort.</td></tr>
<tr valign="top"><td><code>ygrid</code></td>
<td>
do. for the rate-dimension.</td></tr>
<tr valign="top"><td><code>col.grid</code></td>
<td>
The colour of the grid.</td></tr>
<tr valign="top"><td><code>a.lim</code></td>
<td>
Range for the age-axis.</td></tr>
<tr valign="top"><td><code>p.lim</code></td>
<td>
Range for the period-axis.</td></tr>
<tr valign="top"><td><code>c.lim</code></td>
<td>
Range for the cohort-axis.</td></tr>
<tr valign="top"><td><code>ylim</code></td>
<td>
Range for the y-axis (rates).</td></tr>
<tr valign="top"><td><code>at</code></td>
<td>
Position of labels on the y-axis (rates).</td></tr>
<tr valign="top"><td><code>labels</code></td>
<td>
Labels to put on the y-axis (rates).</td></tr>
<tr valign="top"><td><code>a.lab</code></td>
<td>
Text on the age-axis. Defaults to "Age".</td></tr>
<tr valign="top"><td><code>p.lab</code></td>
<td>
Text on the period-axis. Defaults to "Date of diagnosis".</td></tr>
<tr valign="top"><td><code>c.lab</code></td>
<td>
Text on the cohort-axis. Defaults to "Date of birth".</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
Text on the rate-axis. Defaults to the name of the rate-table.</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
How should the curves be plotted. Defaults to <code>"l"</code>.</td></tr>
<tr valign="top"><td><code>lwd</code></td>
<td>
Width of the lines. Defaults to 2.</td></tr>
<tr valign="top"><td><code>lty</code></td>
<td>
Which type of lines should be used. Defaults to 1, a solid line.</td></tr>
<tr valign="top"><td><code>log.ax</code></td>
<td>
Character with letters from <code>"apcyr"</code>, indicating
which axes should be logarithmic. <code>"y"</code> and <code>"r"</code> both
refer to the rate scale. Defaults to <code>"y"</code>.</td></tr>
<tr valign="top"><td><code>las</code></td>
<td>
see <code>par</code>.</td></tr>
<tr valign="top"><td><code>ann</code></td>
<td>
Should the curves be annotated?</td></tr>
<tr valign="top"><td><code>a.ann</code></td>
<td>
Logical indicating whether age-curves should be annotated.</td></tr>
<tr valign="top"><td><code>p.ann</code></td>
<td>
do. for period-curves.</td></tr>
<tr valign="top"><td><code>c.ann</code></td>
<td>
do. for cohort-curves.</td></tr>
<tr valign="top"><td><code>xannx</code></td>
<td>
The fraction that the x-axis is expanded when curves are annotated.</td></tr>
<tr valign="top"><td><code>cex.ann</code></td>
<td>
Expansion factor for characters annotating curves.</td></tr>
<tr valign="top"><td><code>a.thin</code></td>
<td>
Vector of integers indicating which of the age-classes
should be labelled.</td></tr>
<tr valign="top"><td><code>p.thin</code></td>
<td>
do. for the periods.</td></tr>
<tr valign="top"><td><code>c.thin</code></td>
<td>
do. for the cohorts.</td></tr>
<tr valign="top"><td><code>col</code></td>
<td>
Colours for the curves.</td></tr>
<tr valign="top"><td><code>a.col</code></td>
<td>
Colours for the age-curves.</td></tr>
<tr valign="top"><td><code>p.col</code></td>
<td>
do. for the period-curves.</td></tr>
<tr valign="top"><td><code>c.col</code></td>
<td>
do. for the cohort-curves.</td></tr>
<tr valign="top"><td><code>p.lines</code></td>
<td>
Should rates from the same period be connected?</td></tr>
<tr valign="top"><td><code>c.lines</code></td>
<td>
Should rates from the same cohort be connected?</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
Additional arguments pssed on to <code>matlines</code> when
plotting the curves.</td></tr>
</table>

<h3>Details</h3>

<p>
Zero values of the rates are ignored. They are neiter in the plot nor in
the calculation of the axis ranges.
</p>


<h3>Value</h3>

<p>
<code>NULL</code>. The function is used for its side-effect, the plot.</p>

<h3>Author(s)</h3>

<p>
Bendix Carstensen, Steno Diabetes Center,
<a href="http://www.pubhealth.ku.dk/~bxc/">http://www.pubhealth.ku.dk/~bxc/</a>
</p>


<h3>See Also</h3>

<p>
<code><a href="apc.frame.html">apc.frame</a></code>
</p>


<h3>Examples</h3>

<pre>
data( blcaIT )
attach(blcaIT)

# Table of rates:
bl.rate &lt;- tapply( D, list(age,period), sum ) /
           tapply( Y, list(age,period), sum )
bl.rate

# The four classical plots:
par( mfrow=c(2,2) )
rateplot( bl.rate*10^6 )

# The labels on the vertical axis could be nicer:
rateplot( bl.rate*10^6, at=10^(-1:3), labels=c(0.1,1,10,100,1000) ) 

# More bells an whistles
par( mfrow=c(1,3), mar=c(3,3,1,1), oma=c(0,3,0,0), mgp=c(3,1,0)/1.6 )
rateplot( bl.rate*10^6, ylab="", ann=TRUE, which=c("AC","PA","CA"),
                      at=10^(-1:3), labels=c(0.1,1,10,100,1000),
                      col=topo.colors(11), cex.ann=1.2 ) 
</pre>



<hr><div align="center">[Package <em>Epi</em> version 0.8.0 <a href="00Index.html">Index]</a></div>

</body></html>
